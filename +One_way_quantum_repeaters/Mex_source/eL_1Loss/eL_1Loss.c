#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include "eL_1Loss.h"

double eL_1Loss(double z, double t){
    // Derived using logical ket(+) state and qubits lost are [qubit1]
    // with error syndrome 0.
    // The full 9-qubit circuit was used to derive the expression.
	// z is e0.
	// t is etrans.
    double t2 = t*t;
    double t3 = t*t2;
    double t4 = t2*t2;
    double z2 = z*z;
    double z3 = z2*z;
    double z4 = z2*z2;
    double z5 = z3*z2;
    double z6 = z3*z3;
    double z7 = z3*z4;
    double z8 = z4*z4;
    double z9 = z5*z4;
    double z10 = z5*z5;
    double z11 = z5*z6;
    double z12 = z6*z6;
    double z13 = z7*z6;
    double z14 = z7*z7;
    double z15 = z7*z8;
    double z16 = z8*z8;
	
	double q = (16*z - 15);
	double q2 = q*q;
	double q3 = q2*q;
	double q4 = q2*q2;
	double q5 = q2*q3;
	double q6 = q3*q3;
	double q7 = q3*q4;
	double q8 = q4*q4;
	double q9 = q4*q5;
	
	double v = (4*t - 3);
	double v2 = v*v;
	double v3 = v2*v;
	
	double w = (14*z - 15);
	double w2 = w*w;
	double w3 = w2*w;
	double w4 = w2*w2;
	double w5 = w2*w3;
	double w6 = w3*w3;
	double w7 = w3*w4;
	
	double a = (224*z2 - 450*z + 225);
	double a2 = a*a;
	double a3 = a*a2;
	
	double b = (224*z3 - 674*z2 + 675*z - 225);
	double b2 = b*b;
	
	double c = (z - 1);
	double c2 = c*c;
	
	double h = (16*z2 - 31*z + 15);
	double h2 = h*h;
	
	double k = (14*z2 - 29*z + 15);
	double k2 = k*k;
	
	double zt = z*t;
	double z2t = z2*t;
	double z3t = z3*t;
	double z4t = z4*t;
	double z5t = z5*t;
	double z6t = z6*t;
	double z7t = z7*t;
	double z8t = z8*t;
	double z9t = z9*t;
	double z10t = z10*t;
	double z11t = z11*t;
	double z12t = z12*t;
	double z13t = z13*t;
	double z14t = z14*t;
	double z15t = z15*t;
	
	double zt2 = z*t2;
	double z2t2 = z2*t2;
	double z3t2 = z3*t2;
	double z4t2 = z4*t2;
	double z5t2 = z5*t2;
	double z6t2 = z6*t2;
	double z7t2 = z7*t2;
	double z8t2 = z8*t2;
	double z9t2 = z9*t2;
	double z10t2 = z10*t2;
	double z11t2 = z11*t2;
	double z12t2 = z12*t2;
	double z13t2 = z13*t2;
	double z14t2 = z14*t2;
	double z15t2 = z15*t2;
	
	double zt3 = z*t3;
	double z2t3 = z2*t3;
	double z3t3 = z3*t3;
	double z4t3 = z4*t3;
	double z5t3 = z5*t3;
	double z6t3 = z6*t3;
	double z7t3 = z7*t3;
	double z8t3 = z8*t3;
	double z9t3 = z9*t3;
	double z10t3 = z10*t3;
	double z11t3 = z11*t3;
	double z12t3 = z12*t3;
	double z13t3 = z13*t3;
	double z14t3 = z14*t3;
	double z15t3 = z15*t3;
	
	double zt4 = z*t4;
	double z2t4 = z2*t4;
	double z3t4 = z3*t4;
	double z4t4 = z4*t4;
	double z5t4 = z5*t4;
	double z6t4 = z6*t4;
	double z7t4 = z7*t4;
	double z8t4 = z8*t4;
	double z9t4 = z9*t4;
	double z10t4 = z10*t4;
	double z11t4 = z11*t4;
	double z12t4 = z12*t4;
	double z13t4 = z13*t4;
	double z14t4 = z14*t4;
	double z15t4 = z15*t4;
	
	// double p00 = 9.51524275217153e-21*(9.730975341796876e17*(27. + 4.*t*(-3. + 2.*t)*(9. + 4.*t*(-3. + 2.*t))) - 2.4435560302734377e18*(3. - 4.*t)^4*z + 7.2081298828125e14*(-3. + 4.*t)^3*(-48297. + 64390.*t)*z2 - 7.2081298828125e13*(-3. + 4.*t)^3*(-1.432243e6 + 1.908864e6*t)*z3 + 3.20361328125e12*(1.786203981e9 + 8.*t*(-1.190432727e9 + 8.*t*(2.97515727e8 - 2.64376242e8*t + 8.809802e7*t2)))*z4 - 4.271484375e11*(1.9928559033e10 + 2.*t*(-5.3100881667e10 + 4.*t*(2.6529469677e10 + 4.*t*(-5.890777449e9 + 1.962039064e9*t))))*z5 + 7.119140625e9*(1.313745601581e12 + 16.*t*(-4.37096420397e11 + 2.*t*(4.36277645073e11 + 8.*t*(-4.8384318861e10 + 1.6097781275e10*t))))*z6 - 4.74609375e8*(1.6063469553897e13 + 184.*t*(-4.63581678087e11 + 4.*t*(2.30777784585e11 + 4.*t*(-5.1058828917e10 + 1.6944568568e10*t))))*z7 + 6.328125e7*(7.2606105040689e13 + 8.*t*(-4.7905289488917e13 + 2.*t*(4.7406521126331e13 + 8.*t*(-5.211972529305e12 + 1.718851274117e12*t))))*z8 - 1.265625e7*(1.61353878406119e14 + 32.*t*(-2.6211884617395e13 + t*(5.1062966758179e13 + 8.*t*(-5.522462697952e12 + 1.790420807591e12*t))))*z9 + 140625.*(4.885804974308211e15 + 4.*t*(-6.103231395275475e15 + 4.*t*(2.846040195558033e15 + 4.*t*(-5.86769931884073e14 + 1.80362162325824e14*t))))*z10 - 18750.*(1.0572221951965036e16 + 2.*t*(-2.4228231641568548e16 + 4.*t*(1.0132093693867312e16 + 4.*t*(-1.811127014877855e15 + 4.56892551113584e14*t))))*z11 + 1250.*(4.869817981869097e16 + 4.*t*(-5.051373734700974e16 + 4.*t*(1.804900498941158e16 + 4.*t*(-2.409142512292953e15 + 2.69131675646296e14*t))))*z12 - 2500.*(7.711584052167477e15 + 8.*t*(-3.861822352152699e15 + 2.*t*(2.582737840552455e15 + 8.*t*(-1.44850369883579e14 + 9.09956198221e11*t))))*z13 + 9600.*(4.94252541607356e14 + 25.*t*(-7.9247866808322e13 + t*(1.06116948080037e14 + 8.*t*(-5.97090694927e12 + 5.0347296549e10*t))))*z14 - 40.*(1.810386943542752e16 + 1000.*t*(-7.2616471592139e13 + 16.*t*(6.085233734751e12 + t*(-2.749696462653e12 + 3.0098757398e10*t))))*z15 + 32.*(1.616359423290863e15 + 5000.*t*(-1.29765608793e12 + t*(1.742474557989e12 + 8.*t*(-9.8848548902e10 + 1.362937861e9*t))))*z16);
	// double p01 = 9.51524275217153e-21*(9.730975341796876e17*(27. + 4.*t*(-3. + 2.*t)*(9. + 4.*t*(-3. + 2.*t))) - 2.4435560302734377e18*(3. - 4.*t)^4*z + 1.4416259765625e15*(-3. + 4.*t)^3*(-24144. + 32195.*t)*z2 - 7.2081298828125e13*(-3. + 4.*t)^3*(-1.431055e6 + 1.908864e6*t)*z3 + 2.883251953125e13*(1.97975187e8 + 4.*t*(-2.64048687e8 + 4.*t*(1.32065235e8 + 4.*t*(-2.9356917e7 + 9.788668e6*t))))*z4 - 8.54296875e11*(9.901520919e9 + t*(-5.2849839771e10 + 4.*t*(2.6445783933e10 + 4.*t*(-5.881477329e9 + 1.962037928e9*t))))*z5 + 7.119140625e9*(1.294136530929e12 + 32.*t*(-2.16096936642e11 + t*(4.33008898335e11 + 8.*t*(-4.8202658154e10 + 1.6097738831e10*t))))*z6 - 4.74609375e8*(1.5505101006885e13 + 16.*t*(-5.191582831497e12 + 4.*t*(2.607399184833e12 + 4.*t*(-5.82001545315e11 + 1.94860349852e11*t))))*z7 + 1.8984375e8*(2.2208388838407e13 + 4.*t*(-2.9942853637671e13 + 16.*t*(3.7843142733e12 + t*(-3.400686081681e12 + 1.145845751254e12*t))))*z8 - 1.265625e7*(1.28689014261663e14 + 8.*t*(-8.8510108290111e13 + 8.*t*(2.2806858194019e13 - 2.0876612724898e13*t + 7.160154203556e12*t2)))*z9 + 140625.*(2.416084807788765e15 + 4.*t*(-3.632290000133265e15 + 4.*t*(2.021554760902947e15 + 4.*t*(-4.94881004830947e14 + 1.80175872783376e14*t))))*z10 - 18750.*(-1.346151691533195e15 + 22.*t*(-3.3943263361641e13 + 4.*t*(1.97098847929899e14 + 4.*t*(-8.3828014261995e13 + 4.1285428179856e13*t))))*z11 + 1250.*(-3.809156621313471e16 + 4.*t*(3.6372624987420744e16 + 4.*t*(-1.097896774352858e16 + 4.*t*(8.38138442965953e14 + 2.54497907913704e14*t))))*z12 + 2500.*(7.711584052167477e15 + 8.*t*(-3.861822352152699e15 + 2.*t*(2.582737840552455e15 + 8.*t*(-1.44850369883579e14 + 9.09956198221e11*t))))*z13 - 9600.*(4.94252541607356e14 + 25.*t*(-7.9247866808322e13 + t*(1.06116948080037e14 + 8.*t*(-5.97090694927e12 + 5.0347296549e10*t))))*z14 + 40.*(1.810386943542752e16 + 1000.*t*(-7.2616471592139e13 + 16.*t*(6.085233734751e12 + t*(-2.749696462653e12 + 3.0098757398e10*t))))*z15 - 32.*(1.616359423290863e15 + 5000.*t*(-1.29765608793e12 + t*(1.742474557989e12 + 8.*t*(-9.8848548902e10 + 1.362937861e9*t))))*z16);
	// double p10 = 9.51524275217153e-21*(9.730975341796876e17*(27. + 4.*t*(-3. + 2.*t)*(9. + 4.*t*(-3. + 2.*t))) - 2.4435560302734377e18*(3. - 4.*t)^4*z + 7.2081298828125e14*(-3. + 4.*t)^3*(-48297. + 64390.*t)*z2 - 7.2081298828125e13*(-3. + 4.*t)^3*(-1.432243e6 + 1.908864e6*t)*z3 + 6.4072265625e12*(-3. + 4.*t)^3*(-3.3077847e7 + 4.4049002e7*t)*z4 - 2.1357421875e11*(-3. + 4.*t)^3*(-1.476190107e9 + 1.962037736e9*t)*z5 + 7.119140625e9*(1.313750180511e12 + 8.*t*(-8.74194809661e11 + 8.*t*(2.18139039549e11 + 2.*t*(-9.6768611859e10 + 3.2195513158e10*t))))*z6 - 4.74609375e8*(1.6063740827595e13 + 8.*t*(-1.0662507740619e13 + 4.*t*(5.307927188517e12 + 4.*t*(-1.174355668161e12 + 3.89723987032e11*t))))*z7 + 6.328125e7*(7.2610908030945e13 + 4.*t*(-9.5815310113179e13 + 8.*t*(2.3704013619855e13 - 2.0848177521258e13*t + 6.875373571252e12*t2)))*z8 - 1.265625e7*(1.61392414022199e14 + 16.*t*(-5.2433389600011e13 + 2.*t*(5.1069261527721e13 + 8.*t*(-5.522792606159e12 + 1.790407606783e12*t))))*z9 + 140625.*(4.889791822093479e15 + 4.*t*(-6.107233279101813e15 + 4.*t*(2.847362402188791e15 + 4.*t*(-5.86912925517039e14 + 1.8035955018256e14*t))))*z10 - 393750.*(5.04635402086803e14 + 2.*t*(-1.156129228346517e15 + 4.*t*(4.83276572956719e14 + 4.*t*(-8.6330784831151e13 + 2.175559189064e13*t))))*z11 + 1250.*(4.892941276004813e16 + 4.*t*(-5.0745809897554344e16 + 4.*t*(1.812575186628506e16 + 4.*t*(-2.417466396398433e15 + 2.68995977874136e14*t))))*z12 - 2500.*(7.762322766656781e15 + 16.*t*(-1.943614531288782e15 + t*(2.599505100738225e15 + 8.*t*(-1.45753459877654e14 + 8.91006557761e11*t))))*z13 + 1200.*(3.985567974931473e15 + 200.*t*(-7.9877995073757e13 + t*(1.06946708830857e14 + 8.*t*(-6.0152697238e12 + 4.9190599909e10*t))))*z14 - 40.*(1.827642380529002e16 + 1000.*t*(-7.3303472145249e13 + 8.*t*(1.2283274679507e13 - 5.547272286846e12*t + 5.8692730636e10*t2)))*z15 + 32.*(1.634533071315863e15 + 5000.*t*(-1.31207125779e12 + t*(1.761364788309e12 + 8.*t*(-9.9843006782e10 + 1.326271621e9*t))))*z16);
	// double p11 = 9.51524275217153e-21*(9.730975341796876e17*(27. + 4.*t*(-3. + 2.*t)*(9. + 4.*t*(-3. + 2.*t))) - 2.4435560302734377e18*(3. - 4.*t)^4*z + 1.4416259765625e15*(-3. + 4.*t)^3*(-24144. + 32195.*t)*z2 - 7.2081298828125e13*(-3. + 4.*t)^3*(-1.431055e6 + 1.908864e6*t)*z3 + 6.4072265625e12*(8.90887977e8 + 8.*t*(-5.94109377e8 + 2.*t*(5.94293409e8 + 8.*t*(-6.6053049e7 + 2.2024499e7*t))))*z4 - 6.4072265625e11*(-3. + 4.*t)^3*(-4.88963149e8 + 6.540122e8*t)*z5 + 2.1357421875e10*(4.31375985261e11 + 8.*t*(-2.88127704663e11 + 8.*t*(7.2167855409e10 - 6.4270030802e10*t + 2.1463618932e10*t2)))*z6 - 1.423828125e9*(5.168247394833e12 + 64.*t*(-4.32624090231e11 + 2.*t*(4.34560920849e11 + 8.*t*(-4.8499750163e10 + 1.6238317855e10*t))))*z7 + 6.328125e7*(6.6619750343301e13 + 16.*t*(-2.2455753074937e13 + t*(4.5409856427261e13 + 8.*t*(-5.100911856072e12 + 1.718761369705e12*t))))*z8 - 1.265625e7*(1.28648670579783e14 + 8.*t*(-8.8489662182469e13 + 16.*t*(1.1401704732474e13 + t*(-1.0437512615235e13 + 3.580058859794e12*t))))*z9 + 140625.*(2.412043166905497e15 + 28.*t*(-5.18316436977561e14 + 4.*t*(2.88599432220027e14 + 4.*t*(-7.0675699100283e13 + 2.573939701352e13*t))))*z10 - 56250.*(-4.57110831610341e14 + 2.*t*(-1.07578526476581e14 + 4.*t*(7.17097969028367e14 + 4.*t*(-3.06757038848543e14 + 1.5138632448952e14*t))))*z11 + 1250.*(-3.832279915449187e16 + 92.*t*(1.591508588607189e15 + 4.*t*(-4.80683244365307e14 + 4.*t*(3.6802709872671e13 + 1.1071026334168e13*t))))*z12 + 2500.*(7.762322766656781e15 + 16.*t*(-1.943614531288782e15 + t*(2.599505100738225e15 + 8.*t*(-1.45753459877654e14 + 8.91006557761e11*t))))*z13 - 1200.*(3.985567974931473e15 + 200.*t*(-7.9877995073757e13 + t*(1.06946708830857e14 + 8.*t*(-6.0152697238e12 + 4.9190599909e10*t))))*z14 + 40.*(1.827642380529002e16 + 1000.*t*(-7.3303472145249e13 + 8.*t*(1.2283274679507e13 - 5.547272286846e12*t + 5.8692730636e10*t2)))*z15 - 32.*(1.634533071315863e15 + 5000.*t*(-1.31207125779e12 + t*(1.761364788309e12 + 8.*t*(-9.9843006782e10 + 1.326271621e9*t))))*z16);

	// double psum = p00 + p01 + p10 + p11;
	
	double errorrate00 = (2.202602488928595e-23*(4.20378134765625e20*pow(3. - 2.*t,2)*(3. + 8.*(-1. + t)*t) - 4.6708681640625e18*(33777. + t*(-138969. + 2.*t*(116343. + 8.*t*(-10413. + 2633.*t))))*z + 3.89239013671875e16*(2.6970003e7 + 2.*t*(-5.6253663e7 + 8.*t*(1.1829699e7 - 8.529762e6*t + 2.181412e6*t2)))*z2 - 3.89239013671875e15*(1.126963719e9 + 2.*t*(-2.375058375e9 + 4.*t*(1.003459887e9 + 4.*t*(-1.82086797e8 + 4.7060836e7*t))))*z3 + 1.29746337890625e14*(9.9093178251e10 + 2.*t*(-2.10574164213e11 + 4.*t*(8.9333034867e10 + 4.*t*(-1.6306441695e10 + 4.253699288e9*t))))*z4 - 5.76650390625e12*(4.854822720813e12 + 2.*t*(-1.0387812820941e13 + 4.*t*(4.422308942727e12 + 4.*t*(-8.11269216663e11 + 2.1326770424e11*t))))*z5 + 1.537734375e12*(3.044170945431e13 + t*(-1.31035470255837e14 + 2.*t*(1.11879348828777e14 + 8.*t*(-1.0302580822413e13 + 2.724707628691e12*t))))*z6 - 5.12578125e10*(1.195546280506983e15 + t*(-5.172186805961787e15 + 4.*t*(2.212414292861487e15 + 4.*t*(-4.08607818387129e14 + 1.08522672046124e14*t))))*z7 + 8.54296875e8*(7.426817376431074e16 + 2.*t*(-1.6135580958215152e17 + 4.*t*(6.90986517110022e16 + 4.*t*(-1.2782088584650808e16 + 3.402973744507784e15*t))))*z8 - 1.1390625e8*(4.5744148847992915e17 + 2.*t*(-9.976625982630124e17 + 4.*t*(4.2734077919254394e17 + 4.*t*(-7.907783538968483e16 + 2.106368439367552e16*t))))*z9 + 2.278125e7*(1.4844665886800417e18 + 14.*t*(-4.640676320185855e17 + 8.*t*(9.93216184722703e16 + 2.*t*(-3.672281286217522e16 + 9.767561393706394e15*t))))*z10 - 506250.*(3.389367954309105e19 + 4.*t*(-3.719425079338543e19 + 4.*t*(1.5894574033361283e19 + 4.*t*(-2.9315605933399665e18 + 7.76997874570253e17*t))))*z11 + 270000.*(2.470482359761821e19 + t*(-1.0872012114856835e20 + 2.*t*(9.267275519695967e19 + 8.*t*(-8.513932138372333e18 + 2.2436304923608266e18*t))))*z12 - 13500.*(1.4223381057011784e20 + 4.*t*(-1.568275015266845e20 + 8.*t*(3.329483590510729e19 - 2.4340263492038627e19*t + 6.361705763549517e18*t2)))*z13 + 2400.*(1.6081343794792458e20 + 4.*t*(-1.7763562408820133e20 + t*(3.002258808258354e20 + 8.*t*(-2.7242279275029795e19 + 7.042042449062996e18*t))))*z14 - 80.*(6.048772304293826e20 + 16.*t*(-1.6727253038467193e20 + t*(2.8097881659381046e20 + 8.*t*(-2.5268063602030785e19 + 6.438752897879394e18*t))))*z15 + 64.*(4.454547224129846e19 + t*(-1.9727809562291005e20 + 8.*t*(4.111181634937812e19 - 2.9248096704914424e19*t + 7.317452218275358e18*t2)))*z16));
	double errorrate02 = (7.34200829642865e-24*(-8.4075626953125e20*t*(-3. + 2.*t)*(9. + 4.*t*(-3. + 2.*t)) + 4.20378134765625e19*(351. + 10.*t*(-810. + t*(1629. + 8.*t*(-182. + 61.*t))))*z - 2.33543408203125e17*(625320. + 7.*t*(-1.452357e6 + 16.*t*(183330. + t*(-164547. + 55378.*t))))*z2 + 7.7847802734375e15*(9.7162902e7 + t*(-1.321586631e9 + 4.*t*(6.69426255e8 + 4.*t*(-1.50679821e8 + 5.0866084e7*t))))*z3 - 1.29746337890625e14*(1.9826989569e10 + 2.*t*(-1.20015972405e11 + 4.*t*(6.0930703899e10 + 4.*t*(-1.3745204799e10 + 4.650084392e9*t))))*z4 + 1.3839609375e14*(4.5666013464e10 + t*(-5.05885552677e11 + 4.*t*(2.57211719487e11 + 4.*t*(-5.8106813919e10 + 1.9685155984e10*t))))*z5 - 3.45990234375e12*(3.404618278695e12 + 8.*t*(-4.374430923294e12 + t*(8.903536161993e12 + 8.*t*(-1.006467830822e12 + 3.41217955289e11*t))))*z6 + 2.3066015625e11*(7.4170791063819e13 + 2.*t*(-3.56404674715227e14 + 4.*t*(1.81394578467063e14 + 4.*t*(-4.1019293239225e13 + 1.3909560050812e13*t))))*z7 - 2.3066015625e10*(8.50826675409561e14 + 2.*t*(-3.840711134237181e15 + 4.*t*(1.954400668645779e15 + 4.*t*(-4.41876837816215e14 + 1.49814138644456e14*t))))*z8 + 1.366875e9*(1.3064079185724176e16 + t*(-1.1119598672062592e17 + 4.*t*(5.655933481830096e16 + 4.*t*(-1.2782372505841988e16 + 4.332001313650144e15*t))))*z9 - 4.55625e7*(2.818802322355928e17 + t*(-2.2693020366294756e18 + 16.*t*(2.8842396428060045e17 + t*(-2.6060904354001466e17 + 8.828040998057259e16*t))))*z10 + 1.51875e6*(4.753295021608447e18 + 4.*t*(-9.078622821981198e18 + 4.*t*(4.613805490650335e18 + 4.*t*(-1.0418443489577935e18 + 3.527995296273931e17*t))))*z11 - 607500.*(5.11172633590075e18 + 8.*t*(-4.64905124560944e18 + t*(9.450463963115155e18 + 8.*t*(-1.0669806038901591e18 + 3.613032187743595e17*t))))*z12 + 40500.*(2.436884354236846e19 + 4.*t*(-4.237677610230821e19 + 16.*t*(5.386844528521303e18 + t*(-4.868081817114738e18 + 1.6492857955516613e18*t))))*z13 - 3600.*(6.062261656251625e19 + 28.*t*(-1.4456676329024741e19 + 2.*t*(1.472160073645037e19 + 8.*t*(-1.6651694604306668e18 + 5.6486850190006035e17*t))))*z14 + 960.*(3.1205009425219056e19 + t*(-2.0086650663526403e20 + 8.*t*(5.12607244297661e19 + 2.*t*(-2.324658764476275e19 + 7.903543699506117e18*t))))*z15 - 64.*(3.000298851837079e19 + t*(-1.8700078228051542e20 + 16.*t*(2.3950428788856218e19 + t*(-2.1800675371242676e19 + 7.437360235982164e18*t))))*z16));

	return 1.0 - (4.*errorrate00 + 12.*errorrate02);
}